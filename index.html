<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Matrix Club Berlin ‚Äî Home (Redesign)</title>

<!-- Poppins -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#1A1F2B; /* night blue */
  --secondary:#00A6A6; /* island turquoise */
  --accent:#F2C94C; /* sand yellow */
  --bg:#F8F9FA; /* page background (light) */
  --muted:#6B7280;
  --white:#ffffff;
  --card-bg:#ffffff;
  --glass: rgba(255,255,255,0.8);
  --btn-radius:28px;
  --shadow: 0 12px 30px rgba(26,31,43,0.08);
}

/* Reset & base */
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:"Poppins",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:var(--primary);background:var(--bg);-webkit-font-smoothing:antialiased}
a{color:inherit}
.container{max-width:1200px;margin:0 auto;padding:0 20px}

/* Header */
.site-header{background:var(--primary);padding:12px 0;position:sticky;top:0;z-index:40}
.header-inner{display:flex;align-items:center;justify-content:space-between}
.logo{font-weight:800;letter-spacing:2px;font-size:22px;color:var(--white);background:transparent;padding:6px 10px;border-radius:6px}
.logo small{color:var(--accent);font-weight:600;margin-left:10px}

/* Language toggle */
.lang-toggle{display:flex;gap:8px;align-items:center;cursor:pointer}
.lang-toggle img{width:26px;height:auto;border-radius:3px}
.lang-label{font-weight:700;color:var(--white);font-size:14px}

/* Hero */
.hero{background-image:url('https://www.matrix-berlin.de/wp-content/uploads/2018/06/wordpress-beispiel-seite-matrix-club-berlin-mainhall-1772x1080.jpg');background-size:cover;background-position:center;padding:56px 0 36px;position:relative;color:var(--white)}
/* dark top overlay for contrast on hero logo/header only */
.hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(26,31,43,0.75), rgba(26,31,43,0.35));z-index:0}
.hero .container{position:relative;z-index:2}

/* Hero content layout */
.hero-top{display:flex;flex-direction:column;gap:18px;align-items:center}
.hero h1{font-size:42px;margin:0 0 6px;font-weight:800;color:var(--accent);font-family:'Poppins',sans-serif}
.hero-search-wrap{
  width:100%;
  max-width:820px;
  margin:0 auto;
  text-align:center; /* center content */
}
.hero .search-input{
  width:100%;
  padding:14px 18px;
  border-radius:40px;
  background:rgba(255,255,255,0.95);
  border:1px solid rgba(26,31,43,0.06);
  color:var(--primary);
  font-weight:600;
  font-size:15px;
  box-shadow:var(--shadow);
}

/* center day nav below search */
.day-nav{display:flex;gap:10px;margin:10px 0 0;flex-wrap:wrap;justify-content:center}
.day-nav a{color:rgba(255,255,255,0.95);text-decoration:none;padding:8px 12px;border-radius:8px;background:rgba(0,0,0,0.18);font-weight:700}

/* highlight area */
.highlight-wrap{display:grid;grid-template-columns:1fr 420px;gap:24px;align-items:center;margin-top:18px}
@media(max-width:980px){.highlight-wrap{grid-template-columns:1fr}}
.highlight-card{display:flex;gap:0;border-radius:10px;overflow:hidden;box-shadow:0 14px 40px rgba(26,31,43,0.12);background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.92))}
.highlight-card img{width:100%;height:100%;object-fit:cover}
.highlight-info{padding:18px;color:var(--primary)}
.highlight-info .meta{color:var(--muted);font-size:13px;margin-bottom:6px}
.highlight-info h2{margin:0 0 8px;font-size:20px}

/* CTA */
.cta-show{display:inline-block;margin:24px 0;padding:12px 26px;border-radius:30px;background:var(--secondary);color:var(--white);font-weight:700;text-decoration:none;box-shadow:0 10px 30px rgba(0,166,166,0.12)}

/* Section titles */
.section{padding:60px 0}
.section .title{font-size:44px;margin:0 0 18px;font-weight:800;color:var(--primary)}

/* EVENTS GRID (cards) */
.events-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
@media(max-width:1000px){.events-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:640px){.events-grid{grid-template-columns:1fr}}

.card{background:var(--card-bg);border-radius:12px;overflow:hidden;box-shadow:0 14px 40px rgba(16,24,40,0.06);display:flex;flex-direction:column;min-height:420px;border:1px solid rgba(16,24,40,0.04)}
.card .media{height:220px;background-size:cover;background-position:center;position:relative;cursor:pointer}
.card .date-pill{position:absolute;left:16px;top:16px;background:var(--secondary);color:var(--primary);padding:8px 12px;border-radius:8px;font-weight:700}
.card .card-body{padding:18px;display:flex;flex-direction:column;gap:12px;flex:1}
.card h3{margin:0;font-size:20px;color:var(--primary);font-weight:800}
.card .meta{color:var(--muted);font-size:14px}
.countdown{font-weight:800}
.countdown.green{color:#16a34a}
.countdown.yellow{color:#F59E0B}
.countdown.red{color:#ef4444}

/* Buttons */
.btn{display:inline-block;padding:10px 18px;border-radius:var(--btn-radius);font-weight:700;text-decoration:none}
.btn-primary{background:var(--secondary);color:var(--white)}
.btn-outline{background:transparent;border:2px solid rgba(26,31,43,0.06);color:var(--primary)}

/* highlights (light) */
.highlights{background:transparent;color:var(--primary);padding:40px 0;border-radius:8px}
.featured{display:flex;gap:18px;align-items:center}
.featured img{width:360px;border-radius:8px;object-fit:cover;height:200px}
.featured .info{flex:1}

/* Photos grid */
.photos-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}
@media(max-width:1000px){.photos-grid{grid-template-columns:repeat(4,1fr)}}
@media(max-width:640px){.photos-grid{grid-template-columns:repeat(3,1fr)}}
.photos-grid img{width:100%;height:100%;object-fit:cover;border-radius:6px;border:3px solid rgba(16,24,40,0.02)}

/* About */
.about{display:grid;grid-template-columns:1fr 380px;gap:24px;align-items:start}
@media(max-width:900px){.about{grid-template-columns:1fr}}

.video-embed{width:100%;height:260px;background:#000;border-radius:8px;display:flex;align-items:center;justify-content:center;color:var(--white)}

/* Footer */
.site-footer{background:linear-gradient(180deg, rgba(26,31,43,0.02), rgba(26,31,43,0.01));padding:30px 0;color:var(--muted)}
.footer-links{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.socials{display:flex;gap:10px;justify-content:center;margin-top:12px}

/* Modal gallery */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:60}
.modal{background:var(--primary);width:92%;max-width:1000px;border-radius:10px;overflow:hidden;color:var(--white)}
.modal-body{display:grid;grid-template-columns:1fr 320px}
@media(max-width:860px){.modal-body{grid-template-columns:1fr}}
.gallery{padding:12px;display:flex;flex-wrap:wrap;gap:10px}
.thumb{width:calc(33.333% - 6px);background-size:cover;background-position:center;height:120px;border-radius:8px;cursor:pointer;border:4px solid rgba(255,255,255,0.02)}
@media(max-width:640px){.thumb{width:calc(50% - 6px)}}
.modal .info{padding:18px;border-left:1px solid rgba(255,255,255,0.02)}
.download{display:inline-block;margin-top:12px;padding:10px 12px;border-radius:8px;background:var(--secondary);color:white;text-decoration:none;font-weight:700}

/* Chat */
.chat-btn{position:fixed;right:22px;bottom:22px;background:var(--accent);color:var(--primary);border-radius:50%;width:64px;height:64px;display:flex;align-items:center;justify-content:center;font-weight:800;z-index:80;box-shadow:0 14px 40px rgba(0,0,0,0.12);cursor:pointer}
.chat-panel{position:fixed;right:22px;bottom:100px;width:340px;max-width:92%;background:white;border-radius:10px;box-shadow:0 20px 60px rgba(16,24,40,0.08);z-index:85;display:none;overflow:hidden}
.chat-header{padding:12px 14px;font-weight:800;background:linear-gradient(90deg,var(--secondary), #009994);color:white}
.chat-body{padding:12px;color:var(--primary)}
.chat-footer{padding:8px;border-top:1px solid rgba(16,24,40,0.04);display:flex;gap:8px}
.chat-footer input{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(16,24,40,0.06);background:transparent;color:var(--primary)}
.chat-footer button{background:var(--secondary);color:white;border:none;padding:8px 12px;border-radius:6px;font-weight:700}

/* small helper */
.kv{font-weight:700}
.badge-free{background:rgba(242,201,76,0.12);color:var(--accent);padding:6px 8px;border-radius:6px;font-weight:700;display:inline-block}

/* Photo overlay */
.photo-wrapper{position:relative;overflow:hidden;border-radius:6px;}
.photo-wrapper img{display:block;width:100%;height:100%;object-fit:cover;}
.photo-overlay{position:absolute;inset:0;background:rgba(0,0,0,0.55);display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:6px;opacity:0;transition:0.18s ease;}
.photo-overlay div, .photo-overlay a{background:var(--secondary);color:var(--white);padding:8px 12px;margin:6px;border-radius:20px;font-weight:700;text-decoration:none;}
.photo-wrapper:hover .photo-overlay{opacity:1;}

/* Photo modal X */
#photoModalClose{position:absolute;top:18px;right:24px;font-size:36px;color:var(--primary);cursor:pointer;z-index:20001;}

/* Menu overlay */
#menuOverlay{display:none;}
#menuOverlay .menuLinks{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:26px;align-items:center}
#menuOverlay .menuLinks a{color:var(--white);font-size:34px;text-decoration:none;font-weight:800}
#menuOverlay .menu-top-bar{position:absolute;top:18px;right:18px;display:flex;gap:12px;align-items:center;z-index:10002}
/* keep close & flag fixed at top-right on open */
#menuOverlay .menu-top-bar img{width:36px;border-radius:3px;}
#menuOverlay .menu-top-bar #menuClose{font-size:46px;font-weight:800;color:var(--accent);cursor:pointer;background:transparent;border:none;padding:0;line-height:1}
#menuOverlay .menuSocials{display:flex;gap:24px;margin-top:34px;align-items:center}
.menu-social-circle{width:48px;height:48px;border-radius:999px;background:var(--white);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 24px rgba(16,24,40,0.06)}
.menu-lang-label{margin-top:18px;color:var(--white);font-weight:700}

/* NO RESULTS hero message with fade + scale animation (Option C) */
#noResultsHero{
  display:inline-block;
  opacity:0;
  transform:scale(0.95);
  transition: opacity 260ms ease, transform 260ms cubic-bezier(.2,.9,.3,1);
  color:var(--white);
  background:rgba(0,0,0,0.35);
  padding:8px 14px;
  border-radius:10px;
  margin-top:8px;
  font-weight:700;
}
#noResultsHero.visible{
  opacity:1;
  transform:scale(1);
}

/* events section no results (kept for fallback) */
#noResults{display:none;color:var(--muted);margin-top:18px;text-align:center;}
</style>
</head>
<body>

<!-- HEADER -->
<header class="site-header">
  <div class="container header-inner">
    <div class="logo">M√ÅTRIX <small>Party Every Night</small></div>
    <nav aria-label="Top" style="display:flex;align-items:center;gap:14px">
      <div id="langToggle" class="lang-toggle" title="Toggle language" role="button" aria-pressed="false">
        <img id="langFlag" src="https://flagcdn.com/w40/de.png" alt="language flag">
        <div id="langLabel" class="lang-label">Deutsch</div>
      </div>
      <button id="hamburgerMenu" aria-label="Open menu" style="background:transparent;border:none;color:var(--white);font-size:20px;cursor:pointer">‚ò∞</button>
    </nav>
  </div>
</header>

<!-- FULLSCREEN MENU OVERLAY -->
<div id="menuOverlay" style="position:fixed;inset:0;background:var(--primary);display:none;flex-direction:column;align-items:center;padding-top:110px;z-index:9999;">
  <!-- top-right close & flag (fixed position inside overlay) -->
  <div class="menu-top-bar">
    <img src="https://flagcdn.com/w40/de.png" id="menuLang" alt="lang flag">
    <button id="menuClose" aria-label="Close menu">&times;</button>
  </div>

  <ul class="menuLinks" style="text-align:center;">
    <li><a href="#">Clubnights</a></li>
    <li><a href="#">Photos & Videos</a></li>
    <li><a href="#">Reservation</a></li>
    <li><a href="#">Directions</a></li>
    <li><a href="#">Contact</a></li>
  </ul>

  <div class="menuSocials" style="display:flex;gap:18px;margin-top:32px;">
    <div class="menu-social-circle" aria-hidden="true">
      <!-- facebook SVG -->
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M22 12C22 6.48 17.52 2 12 2S2 6.48 2 12c0 4.84 3.44 8.84 8 9.8V15H7v-3h3V9.4c0-3 1.78-4.6 4.5-4.6 1.3 0 2.66.24 2.66.24v3h-1.5c-1.48 0-1.94.92-1.94 1.86V12h3.3l-.53 3H17v6.8c4.56-.96 8-4.96 8-9.8z" fill="#1A1F2B"/>
      </svg>
    </div>

    <div class="menu-social-circle" aria-hidden="true">
      <!-- instagram SVG -->
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 6.2A4.8 4.8 0 1016.8 13 4.8 4.8 0 0012 8.2zm6-2a1.2 1.2 0 11-1.2-1.2A1.2 1.2 0 0118 6.2z" fill="#1A1F2B"/>
      </svg>
    </div>

    <div class="menu-social-circle" aria-hidden="true">
      <!-- youtube SVG -->
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 15l5.2-3L10 9v6zM23 7.5s-.2-1.7-.8-2.5c-.8-.9-1.7-.9-2.1-1C16.6 3.6 12 3.6 12 3.6h0s-4.6 0-8.1.4c-.4.1-1.3.1-2.1 1-.6.8-.8 2.5-.8 2.5S0 9.2 0 10.8v2.5C0 15 0 16.6 0 16.6s.2 1.7.8 2.5c.8.9 1.9.9 2.4 1 1.8.2 7.9.4 7.9.4s4.6 0 8.1-.4c.4-.1 1.3-.1 2.1-1 .6-.8.8-2.5.8-2.5s.2-1.6.2-3.2v-2.5c0-1.6-.2-3.1-.2-3.1z" fill="#1A1F2B"/>
      </svg>
    </div>
  </div>

  <div class="menu-lang-label" id="menuLangSwitch">Deutsch</div>
</div>

<!-- HERO / CLUBNIGHTS -->
<section class="hero" aria-label="Clubnights">
  <div class="container">
    <div class="hero-top">
      <h1 id="heroTitle">Clubnights</h1>

      <!-- SEARCH (centered) -->
      <div class="hero-search-wrap">
        <input id="searchInputHero" class="search-input" placeholder="Search events by name, genre, DJ..." aria-label="Search events">
        <!-- hero no results message (fade+scale) -->
        <p id="noResultsHero" aria-live="polite" role="status"></p>
      </div>

      <div class="day-nav" role="tablist" aria-label="Days">
        <a href="#" class="day active">Today</a>
        <a href="#">Wed</a><a href="#">Thu</a><a href="#">Fri</a><a href="#">Sat</a><a href="#">Sun</a><a href="#">Mon</a>
      </div>
    </div>

    <div style="display:flex;gap:24px;align-items:center;flex-direction:column">
      <div style="width:100%;max-width:1100px">
        <div class="highlight-wrap">
          <div class="highlight-card">
            <img src="https://www.matrix-berlin.de/wp-content/uploads/2021/10/www.matrix-berlin.de-matrix-tuesday-v3-facebook-570x320.jpg" alt="Matrix - Tuesday">
          </div>
          <div class="highlight-info">
            <div class="meta" id="highlightMeta">Today 09.12.2025 | 22:00o'clock</div>
            <h2 id="highlightTitle">Matrix - Tuesday</h2>
            <p style="margin:8px 0;color:var(--muted)" id="highlightGenres">afrobeats ‚Ä¢ dance classics ‚Ä¢ electro ‚Ä¢ hip-hop ‚Ä¢ house ‚Ä¢ reggaeton ‚Ä¢ top40</p>
            <ul style="color:var(--muted);margin:6px 0;padding-left:18px" id="highlightBullets">
              <li>DJ TC (Blactro)</li>
              <li>Only 5‚Ç¨ Entry for Ladies & students until midnight!</li>
            </ul>
            <div style="margin-top:10px"><a id="ctaMore" class="cta-show" href="#">More information</a> <a class="cta-show" href="#" style="background:transparent;color:var(--primary);border:2px solid rgba(26,31,43,0.06)" id="ctaReserve">Reserve a table</a></div>
          </div>
        </div>
      </div>
      <div style="margin-top:18px"><a class="cta-show" href="#">Show all parties</a></div>
    </div>

  </div>
</section>

<!-- UPCOMING EVENTS -->
<section class="section">
  <div class="container">
    <h2 class="title" id="eventsTitle">Upcoming Events</h2>

    <div class="events-grid" id="eventsGrid"></div>
    <p id="noResults" style="display:none;color:var(--muted);margin-top:18px;text-align:center;">No events found. Please try another search.</p>

    <p style="margin-top:18px;color:var(--muted)">All photos are free to download at launch. Tap an event to open gallery.</p>
  </div>
</section>

<!-- HIGHLIGHTS -->
<section class="section" style="padding-top:10px">
  <div class="container">
    <div class="highlights" style="padding:28px;border-radius:12px">
      <div class="featured">
        <img src="https://www.matrix-berlin.de/wp-content/uploads/2025/10/www.matrix-berlin.de-31-12-2025-new-years-eve-2025-2026-571196275-1301570835348616-303408335329024679-n-570x320.jpg" alt="New Years Eve">
        <div class="info">
          <h3 style="margin:0 0 6px">New Years Eve 2025 / 2026</h3>
          <div class="meta" style="color:var(--muted)">Wednesday 31.12.2025 | 22:00o'clock</div>
          <p style="margin-top:8px;color:var(--muted)">afrobeats ‚Ä¢ dance classics ‚Ä¢ hip-hop ‚Ä¢ house ‚Ä¢ r'n'b ‚Ä¢ top40</p>
          <div style="margin-top:12px"><a class="btn btn-primary" href="#" style="margin-right:12px">More information</a><a class="btn btn-outline" href="#" style="padding:8px 12px">Buy Ticket</a></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- NEWEST PHOTOS -->
<section class="section" style="padding-top:10px">
  <div class="container">
    <h2 class="title" style="margin-bottom:6px" id="photosTitle">Newest photos</h2>
    <p style="color:var(--muted);margin-top:0;margin-bottom:12px" id="photosMeta">Samstag, 06.12.2025 from 06.12.2025</p>

    <div class="photos-grid" id="photosGrid"></div>

    <div style="text-align:center;margin-top:18px">
      <a class="btn btn-primary" href="#" style="padding:12px 26px;border-radius:30px">All photos</a>
    </div>
  </div>
</section>

<!-- ABOUT -->
<section class="section" style="padding-top:10px">
  <div class="container">
    <div class="about">
      <div>
        <h2 class="title" style="margin-bottom:8px">Party Every Night!</h2>
        <p style="color:var(--muted)">For over 25 years, the legendary Matrix has been inspiring up to 5 floors and VIP lounges with its inimitable mix of breathtaking atmosphere and the charm of Berlin‚Äôs nightlife. An institution on everyone‚Äôs lips, a must for all party goers!</p>
        <p style="color:var(--muted)">In the listed underground arches under the U1, right on the Warschauer Bridge, the Matrix is located in the middle of the trendy district of Friedrichshain next Eastside Gallery and Mercedes Benz Square and is an absolute exception with its daily events, even in the party metropolis Berlin!</p>
        <p style="color:var(--muted)"><strong>#matrixberlin #partyeverynight</strong></p>
      </div>
      <div>
        <div class="video-embed">
          <a id="videoLink" href="https://www.youtube.com/watch?v=uZaalzMUT8E" target="_blank" style="color:var(--white);text-decoration:none">‚ñ∂ Matrix Club Berlin ‚Äî Hymn ‚ÄûParty Every Night‚Äú 2020</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer class="site-footer">
  <div class="container">
    <div class="footer-links">
      <a href="#">Lost &amp; Found</a>
      <a href="#">Reservations</a>
      <a href="#">Contact</a>
      <a href="#">Terms of Service</a>
      <a href="#">Privacy Policy</a>
    </div>
    <div class="socials">
      <a href="#" aria-label="facebook" style="color:var(--muted)">ÔÇÇ</a>
      <a href="#" aria-label="instagram" style="color:var(--muted)">ÔÖ≠</a>
      <a href="#" aria-label="youtube" style="color:var(--muted)">ÔÖß</a>
    </div>
  </div>
</footer>

<!-- PHOTO VIEW MODAL -->
<div id="photoModal" style="position:fixed;inset:0;background:rgba(0,0,0,0.85);display:none;justify-content:center;align-items:center;z-index:20000;">
  <span id="photoModalClose" style="position:absolute;top:18px;right:24px;font-size:36px;color:var(--white);cursor:pointer;">&times;</span>
  <img id="photoModalImg" src="" style="max-width:90%;max-height:90%;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,0.7);">
</div>

<!-- Modal gallery -->
<div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true"><span id="modalCloseX" style="position:absolute;right:18px;top:10px;font-size:30px;cursor:pointer;color:var(--accent);z-index:70;">&times;</span>
    <div class="modal-body">
      <div>
        <div class="gallery" id="gallery"></div>
      </div>
      <div class="info">
        <h4 id="modalTitle">Event</h4>
        <div id="modalDate" class="meta"></div>
        <div id="modalDesc" style="margin-top:8px;color:rgba(255,255,255,0.9)"></div>
        <a id="downloadCurrent" class="download" href="#" download>Download current image</a>
        <div style="margin-top:12px"><span class="badge-free">Free photos at launch</span></div>
        <div style="margin-top:18px"><a id="watchVideo" class="btn btn-outline" href="#" target="_blank" style="display:none">Watch mini video</a></div>
      </div>
    </div>
  </div>
</div>

<!-- Chat -->
<div class="chat-panel" id="chatPanel">
  <div class="chat-header">Support Chat</div>
  <div class="chat-body" id="chatBody">
    <div class="bot-line">Hi! I'm the Matrix helper. What's your Instagram handle? (so we can DM event updates)</div>
  </div>
  <div class="chat-footer">
    <input id="chatInput" placeholder="@yourhandle">
    <button id="chatSend">Send</button>
  </div>
</div>
<div class="chat-btn" id="chatBtn" title="Support">üí¨</div>

<script>
/* ---------- data ---------- */
const events = [
  {id:1,title:"Matrix - Thursday",date:"2025-12-11",img:"https://www.matrix-berlin.de/wp-content/uploads/2021/11/www.matrix-berlin.de-matrix-thursday-v4-facebook-570x320.jpg",gallery:["https://www.matrix-berlin.de/wp-content/uploads/2021/11/www.matrix-berlin.de-matrix-thursday-v4-facebook-570x320.jpg"],genre:"afrobeats, dance classics",dj:"DJ TC",video:""},
  {id:2,title:"Matrix - Friday",date:"2025-12-12",img:"https://www.matrix-berlin.de/wp-content/uploads/2021/10/www.matrix-berlin.de-matrix-friday-v2-facebook-570x320.jpg",gallery:["https://www.matrix-berlin.de/wp-content/uploads/2021/10/www.matrix-berlin.de-matrix-friday-v2-facebook-570x320.jpg"],genre:"techno, house",dj:"DJ JC, DJ GUS",video:""},
  {id:3,title:"New Years Eve 2025 / 2026",date:"2025-12-31",img:"https://www.matrix-berlin.de/wp-content/uploads/2025/10/www.matrix-berlin.de-31-12-2025-new-years-eve-2025-2026-571196275-1301570835348616-303408335329024679-n-570x320.jpg",gallery:["https://www.matrix-berlin.de/wp-content/uploads/2025/10/www.matrix-berlin.de-31-12-2025-new-years-eve-2025-2026-571196275-1301570835348616-303408335329024679-n-570x320.jpg"],genre:"multi-genre",dj:"Various",video:"https://www.youtube.com/watch?v=uZaalzMUT8E"}
];

/* photos sample */
const photos = [
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-010-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-011-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-012-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-013-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-014-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-015-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-016-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-017-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-018-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-019-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-020-375x375.jpg",
 "https://www.matrix-berlin.de/wp-content/uploads/2025/12/www.matrix-berlin.de-samstag-06-12-2025-021-375x375.jpg"
];

/* ---------- translations ---------- */
const translations = {
  en: {
    langLabel: 'English',
    heroTitle: 'Clubnights',
    searchPlaceholder: 'Search events by name, genre, DJ...',
    eventsTitle: 'Upcoming Events',
    photosTitle: 'Newest photos',
    photosMeta: 'Saturday, 06.12.2025 from 06.12.2025',
    noResults: 'No events found. Please try another search.',
    tapToOpen: 'Tap to Open',
    downloadText: 'Download',
    moreInfo: 'More information',
    reserve: 'Reserve a table',
    menuLangSwitch: 'English'
  },
  de: {
    langLabel: 'Deutsch',
    heroTitle: 'Clubn√§chte',
    searchPlaceholder: 'Events nach Name, Genre, DJ durchsuchen...',
    eventsTitle: 'Kommende Events',
    photosTitle: 'Neueste Fotos',
    photosMeta: 'Samstag, 06.12.2025 ab 06.12.2025',
    noResults: 'Keine Events gefunden. Bitte versuche eine andere Suche.',
    tapToOpen: 'Tippen zum √ñffnen',
    downloadText: 'Herunterladen',
    moreInfo: 'Mehr Informationen',
    reserve: 'Tisch reservieren',
    menuLangSwitch: 'Deutsch'
  }
};

let currentLang = localStorage.getItem('matrix_lang') || 'de';
function applyTranslations(){
  const t = translations[currentLang];
  document.getElementById('langLabel').textContent = t.langLabel;
  document.getElementById('searchInputHero').placeholder = t.searchPlaceholder;
  document.getElementById('eventsTitle').textContent = t.eventsTitle;
  document.getElementById('photosTitle').textContent = t.photosTitle;
  document.getElementById('photosMeta').textContent = t.photosMeta;
  document.getElementById('noResults').textContent = t.noResults;
  document.getElementById('heroTitle').textContent = t.heroTitle;
  document.getElementById('ctaMore').textContent = t.moreInfo;
  document.getElementById('ctaReserve').textContent = t.reserve;
  document.getElementById('menuLangSwitch').textContent = t.menuLangSwitch;

  // update flag images
  const flag = document.getElementById('langFlag');
  const menuFlag = document.getElementById('menuLang');
  if(currentLang === 'de'){
    flag.src = 'https://flagcdn.com/w40/de.png';
    menuFlag.src = 'https://flagcdn.com/w40/de.png';
  } else {
    flag.src = 'https://flagcdn.com/w40/gb.png';
    menuFlag.src = 'https://flagcdn.com/w40/gb.png';
  }
}
applyTranslations();

/* helper */
function daysLeft(dateStr){
  const now = new Date();
  const d = new Date(dateStr + "T00:00:00");
  return Math.ceil((d - now)/(1000*60*60*24));
}
function countdownClass(days){
  if(days>15) return 'green';
  if(days>7) return 'yellow';
  return 'red';
}

/* ---------- forceDownload (Blob-based cross-origin safe) ---------- */
async function forceDownload(url, suggestedFilename = null){
  try {
    const res = await fetch(url, {mode: 'cors'});
    if(!res.ok) throw new Error('Network response was not ok');
    const blob = await res.blob();
    let filename = suggestedFilename;
    if(!filename){
      try {
        const urlObj = new URL(url);
        filename = urlObj.pathname.split('/').pop() || 'download';
      } catch(e){
        filename = 'download';
      }
    }
    const objectUrl = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = objectUrl;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=> URL.revokeObjectURL(objectUrl), 1000*30);
  } catch(err){
    console.error('Download failed', err);
    window.open(url, '_blank', 'noopener');
  }
}

/* render events */
const grid = document.getElementById('eventsGrid');
function renderEvents(list){
  grid.innerHTML='';
  const noResults = document.getElementById('noResults');
  if(!list || list.length === 0){ noResults.style.display = 'block'; return; } else { noResults.style.display='none'; }
  list.forEach(ev=>{
    const days = daysLeft(ev.date);
    const cls = countdownClass(days);
    const card = document.createElement('article');
    card.className='card';
    card.innerHTML=`
      <div class="media" style="background-image:url('${ev.img}')" data-id="${ev.id}" tabindex="0" role="button" aria-label="Open ${ev.title} gallery">
        <div class="date-pill">${ev.date}</div>
      </div>
      <div class="card-body">
        <h3>${ev.title}</h3>
        <div class="meta">Event Date: ${ev.date}</div>
        <div class="countdown ${cls}">${days} days left</div>
        <div style="margin-top:auto;display:flex;gap:12px;align-items:center">
          <a class="btn btn-primary" href="#" data-open="${ev.id}">${translations[currentLang].moreInfo}</a>
          <button class="btn btn-outline" data-download="${ev.id}" style="background:transparent;border:2px solid rgba(16,24,40,0.06);">Download image</button>
        </div>
      </div>
    `;
    card.querySelector('.media').addEventListener('click', ()=> openModal(ev.id));
    card.querySelector('.media').addEventListener('keypress', (e)=> { if(e.key === 'Enter') openModal(ev.id); });
    card.querySelector('[data-open]').addEventListener('click', (e)=>{e.preventDefault(); openModal(ev.id);});
    card.querySelector('[data-download]').addEventListener('click', (e)=>{ e.preventDefault(); forceDownload(ev.img, `${ev.title.replace(/\s+/g,'_')}.jpg`); });
    grid.appendChild(card);
  });
}
renderEvents(events);

/* search (hero input) */
const searchInput = document.getElementById('searchInputHero');
searchInput.addEventListener('input', () => {
  const q = searchInput.value.trim().toLowerCase();
  const filtered = events.filter(ev=> ev.title.toLowerCase().includes(q) || ev.genre.toLowerCase().includes(q) || ev.dj.toLowerCase().includes(q));
  renderEvents(filtered);

  // hero message handle with fade+scale
  const heroMsg = document.getElementById('noResultsHero');
  if(q && filtered.length === 0){
    heroMsg.textContent = translations[currentLang].noResults;
    heroMsg.classList.add('visible');
  } else {
    heroMsg.classList.remove('visible');
    // clear content a little after to avoid layout jank
    setTimeout(()=> { if(!heroMsg.classList.contains('visible')) heroMsg.textContent = ''; }, 260);
  }
});

/* photos grid with overlay and download */
const photosGrid = document.getElementById('photosGrid');
photos.forEach(src=>{
  const wrapper = document.createElement('div');
  wrapper.className = 'photo-wrapper';
  wrapper.style.position = 'relative';

  const img = document.createElement('img');
  img.src = src;
  img.alt = 'Event photo';
  img.loading = 'lazy';
  img.style.cursor = 'pointer';

  const overlay = document.createElement('div');
  overlay.className = 'photo-overlay';

  const viewBtn = document.createElement('div');
  viewBtn.textContent = translations[currentLang].tapToOpen;
  viewBtn.style.cursor = 'pointer';

  const dl = document.createElement('a');
  dl.textContent = translations[currentLang].downloadText;
  dl.href = '#';
  dl.style.cursor = 'pointer';
  dl.addEventListener('click', (e)=> { e.preventDefault(); e.stopPropagation(); const name = src.split('/').pop(); forceDownload(src, name); });

  overlay.appendChild(viewBtn);
  overlay.appendChild(dl);

  wrapper.appendChild(img);
  wrapper.appendChild(overlay);

  viewBtn.addEventListener('click', (e)=>{ e.stopPropagation(); openPhotoModal(src); });
  img.addEventListener('click', ()=> openPhotoModal(src));
  photosGrid.appendChild(wrapper);
});

/* modal gallery */
const backdrop = document.getElementById('modalBackdrop');
const galleryEl = document.getElementById('gallery');
const modalTitle = document.getElementById('modalTitle');
const modalDate = document.getElementById('modalDate');
const modalDesc = document.getElementById('modalDesc');
const downloadCurrent = document.getElementById('downloadCurrent');
const watchVideo = document.getElementById('watchVideo');
let currentImage = null;

function openModal(id){
  const ev = events.find(x=>x.id===id);
  if(!ev) return;
  modalTitle.textContent = ev.title;
  modalDate.textContent = "Event Date: " + ev.date;
  modalDesc.textContent = "Genres: " + ev.genre + " ‚Ä¢ DJs: " + ev.dj;
  galleryEl.innerHTML='';
  ev.gallery.forEach(src=>{
    const t = document.createElement('div');
    t.className='thumb';
    t.style.backgroundImage = `url('${src}')`;
    t.dataset.src = src;
    t.addEventListener('click', ()=> showImage(src));
    galleryEl.appendChild(t);
  });
  if(ev.gallery.length) showImage(ev.gallery[0]); else showImage(ev.img);
  if(ev.video){ watchVideo.style.display='inline-block'; watchVideo.href = ev.video; } else { watchVideo.style.display='none'; }
  backdrop.style.display='flex'; backdrop.setAttribute('aria-hidden','false');
}
function showImage(src){
  currentImage = src;
  downloadCurrent.href = '#';
  downloadCurrent.onclick = (e)=> { e.preventDefault(); forceDownload(src, src.split('/').pop()); };
  document.querySelectorAll('.thumb').forEach(t=> t.style.borderColor='rgba(255,255,255,0.02)');
  const sel = Array.from(document.querySelectorAll('.thumb')).find(t=>t.dataset.src===src);
  if(sel) sel.style.borderColor='rgba(242,201,76,0.9)';
}
backdrop.addEventListener('click', (e)=> { if(e.target===backdrop){ backdrop.style.display='none'; backdrop.setAttribute('aria-hidden','true'); }});

/* photo modal open/close */
const photoModal = document.getElementById('photoModal');
const photoModalImg = document.getElementById('photoModalImg');
const photoModalClose = document.getElementById('photoModalClose');
function openPhotoModal(src){
  if(photoModalImg) photoModalImg.src = src;
  if(photoModal) photoModal.style.display = 'flex';
}
if(photoModalClose) photoModalClose.addEventListener('click', ()=> { photoModal.style.display = 'none'; })
if(photoModal) photoModal.addEventListener('click', (e)=> { if(e.target.id === 'photoModal') photoModal.style.display = 'none'; })

/* ESC closes modals */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    if(photoModal && photoModal.style.display === 'flex') photoModal.style.display = 'none';
    if(backdrop && backdrop.style.display === 'flex') { backdrop.style.display = 'none'; backdrop.setAttribute('aria-hidden','true'); }
  }
});

/* modal gallery close X */
const modalCloseX = document.getElementById('modalCloseX');
if(modalCloseX){
  modalCloseX.addEventListener('click', ()=> {
    const bd = document.getElementById('modalBackdrop');
    if(bd){ bd.style.display = 'none'; bd.setAttribute('aria-hidden','true'); }
  });
}

/* chat */
const chatBtn = document.getElementById('chatBtn');
const chatPanel = document.getElementById('chatPanel');
const chatSend = document.getElementById('chatSend');
const chatInput = document.getElementById('chatInput');
const chatBody = document.getElementById('chatBody');

chatBtn.addEventListener('click', ()=> {
  chatPanel.style.display = chatPanel.style.display === 'block' ? 'none' : 'block';
});
chatSend.addEventListener('click', ()=> {
  const handle = chatInput.value.trim();
  if(!handle){ alert('Please enter your Instagram handle (e.g. @yourname)'); return; }
  const p = document.createElement('div'); p.style.marginTop='8px'; p.textContent = "Thanks! We'll DM you at " + handle + " with updates.";
  chatBody.appendChild(p);
  localStorage.setItem('matrix_instagram', handle);
  chatInput.value='';
});
const stored = localStorage.getItem('matrix_instagram');
if(stored){ const pm = document.createElement('div'); pm.style.marginTop='8px'; pm.textContent = "Welcome back ‚Äî saved handle: " + stored; chatBody.appendChild(pm); }

/* MENU open/close: ensure close & flag stay at top-right */
const menuOverlay = document.getElementById('menuOverlay');
const hamburger = document.getElementById('hamburgerMenu');
const menuClose = document.getElementById('menuClose');
if(hamburger){ hamburger.addEventListener('click', ()=> { menuOverlay.style.display = 'flex'; }) }
if(menuClose){ menuClose.addEventListener('click', ()=> { menuOverlay.style.display = 'none'; }) }
if(menuOverlay){ menuOverlay.addEventListener('click', (e)=> { if(e.target.id === 'menuOverlay') menuOverlay.style.display = 'none'; }) }

/* Language toggle wiring (header and menu) */
const langToggle = document.getElementById('langToggle');
const menuLangSwitch = document.getElementById('menuLangSwitch');
langToggle.addEventListener('click', toggleLang);
menuLangSwitch.addEventListener('click', toggleLang);
function toggleLang(){
  currentLang = currentLang === 'de' ? 'en' : 'de';
  localStorage.setItem('matrix_lang', currentLang);
  applyTranslations();
  // update overlay strings
  document.querySelectorAll('.photo-overlay').forEach(o=>{
    const view = o.querySelector('div');
    const downloadLink = o.querySelector('a');
    if(view) view.textContent = translations[currentLang].tapToOpen;
    if(downloadLink) downloadLink.textContent = translations[currentLang].downloadText;
  });
  document.querySelectorAll('[data-open]').forEach(el=> { el.textContent = translations[currentLang].moreInfo; });
}

/* ensure downloadCurrent uses forceDownload even if user clicks anchor directly */
if(downloadCurrent){
  downloadCurrent.addEventListener('click', (e)=> {
    e.preventDefault();
    if(currentImage) forceDownload(currentImage, currentImage.split('/').pop());
  });
}

/* init: set hero translations into hero noResults slot if needed (none by default) */
document.querySelectorAll('.photo-overlay').forEach(o=>{
  const view = o.querySelector('div');
  const downloadLink = o.querySelector('a');
  if(view) view.textContent = translations[currentLang].tapToOpen;
  if(downloadLink) downloadLink.textContent = translations[currentLang].downloadText;
});
</script>
</body>
</html>
